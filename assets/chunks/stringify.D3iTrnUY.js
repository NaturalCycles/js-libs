var y=Object.defineProperty;var E=(e,t,r)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var o=(e,t,r)=>E(e,typeof t!="symbol"?t+"":t,r);import{i as O}from"./env.BUzbqU-4.js";const k=/^\s*[{["\-\d]/;function m(e,t){if(typeof e=="string"&&e&&k.test(e))try{return JSON.parse(e,t)}catch{}return e}function M(e,t){try{return JSON.parse(e,t)}catch{throw new w({text:e})}}function p(e,t,r="..."){if(!e||e.length<=t)return e;if(t<=r.length)return r;const n=Math.round((t-r.length)/2),s=e.length-Math.floor((t-r.length)/2);return e.slice(0,n)+r+e.slice(s)}function _(e,t=Error,r){let n;if(e instanceof t)n=e;else{const s=g(e);n=P(s,t)}return r&&(n.data||(n.data={}),Object.assign(n.data,r)),n}function g(e,t){let r;return l(e)?r=d(e):(e=m(e),h(e)?r=e.error:f(e)?r=e:l(e)?r=d(e):r={name:"Error",message:u(e),data:{}}),Object.assign(r.data,t),r}function d(e){if(!(e instanceof Error)&&f(e))return e;const t={name:e.name,message:e.message,data:{...e.data}};return e.stack&&(t.stack=e.stack),e.cause&&(t.cause=g(e.cause)),t}function P(e,t=Error){if(e instanceof t)return e;const{name:r,cause:n}=e,s=new t(e.message,e.data,{name:r,cause:n});return e.stack&&Object.defineProperty(s,"stack",{value:e.stack}),s instanceof a||(Object.defineProperties(s,{name:{value:r,configurable:!0,writable:!0},data:{value:e.data,writable:!0,configurable:!0,enumerable:!1},cause:{value:n,writable:!0,configurable:!0,enumerable:!0}}),Object.defineProperty(s.constructor,"name",{value:r,configurable:!0,writable:!0})),s}function h(e){return f(e==null?void 0:e.error)}function f(e){return!!e&&typeof e=="object"&&typeof e.name=="string"&&typeof e.message=="string"&&typeof e.data=="object"}function l(e){return!!e&&typeof e=="object"&&typeof e.name=="string"&&typeof e.message=="string"}function N(e,t){return t?_(e,void 0,t):e}class a extends Error{constructor(r,n={},s={}){super(r);o(this,"data");o(this,"cause");const{name:i=O()?this.constructor.name:"AppError",cause:c}=s;Object.defineProperties(this,{name:{value:i,configurable:!0,writable:!0},data:{value:n,writable:!0,configurable:!0,enumerable:!1}}),c?Object.defineProperty(this,"cause",{value:g(c),writable:!0,configurable:!0,enumerable:!0}):delete this.cause,Object.defineProperty(this.constructor,"name",{value:i,configurable:!0,writable:!0})}static of(r){return new a(r.message,r.data,{name:r.name,cause:r.cause})}}class $ extends a{constructor(t,r,n){r.response&&Object.defineProperty(r,"response",{enumerable:!1}),super(t,r,{...n,name:"HttpRequestError"})}}class B extends a{constructor(t,r){super(t,r,{name:"AssertionError"})}}class w extends a{constructor(t){const r=["Failed to parse",t.text&&p(t.text,200)].filter(Boolean).join(": ");super(r,t,{name:"JsonParseError"})}}class C extends a{constructor(t,r,n){super(t,r,{...n,name:"TimeoutError"})}}class F extends a{constructor(t){super(t||"expected error was not thrown",{},{name:"UnexpectedPassError"})}}function S(e,t,r,n){try{return JSON.stringify(e,t,r)}catch{return JSON.stringify(e,x(t,n),r)}}function x(e,t){const r=[],n=[];return t??(t=(s,i)=>r[0]===i?"[Circular ~]":"[Circular ~."+n.slice(0,r.indexOf(i)).join(".")+"]"),function(s,i){if(r.length>0){const c=r.indexOf(this);c!==-1?(r.splice(c+1),n.splice(c,1/0,s)):(r.push(this),n.push(s)),r.includes(i)&&(i=t.call(this,s,i))}else r.push(i);return e==null?i:e.call(this,s,i)}}const T=typeof globalThis.AggregateError=="function";let b=S;function u(e,t={}){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="function")return"function";if(typeof e=="symbol")return e.toString();let r;if(e=m(e),h(e))return u(e.error,t);if(e instanceof Error||l(e))r=v(e,t);else if(typeof e=="string")r=e.trim()||"empty_string";else if(typeof e=="number")r=String(e);else{e instanceof Map?e=Object.fromEntries(e):e instanceof Set&&(e=[...e]);try{const{stringifyFn:s=b}=t;r=s(e,void 0,2)}catch{r=String(e)}}if(r===void 0)return"undefined";const{maxLen:n=1e4}=t;return n&&r.length>n?p(r,n,`
... ${Math.ceil(r.length/1024)} Kb message truncated ...
`):r}function v(e,t){const{includeErrorCause:r=!0}=t;let n=[e.name,e.message].filter(Boolean).join(": ");if(typeof e.code=="string"&&(n+=`
code: ${e.code}`),t.includeErrorData&&f(e)&&Object.keys(e.data).length&&(n+=`
`+u(e.data,t)),t.includeErrorStack&&e.stack){const s=n.split(`
`).length;n=[n,...e.stack.split(`
`).slice(s)].join(`
`)}return T&&e instanceof AggregateError&&e.errors.length&&(n=[n,`${e.errors.length} error(s):`,...e.errors.map((s,i)=>`${i+1}. ${u(s,t)}`)].join(`
`)),e.cause&&r&&(n=n+`
Caused by: `+u(e.cause,t)),n}export{B as A,$ as H,C as T,F as U,u as _,N as a,_ as b,M as c,m as d,d as e,g as f};
